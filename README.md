
---
# НИР Ассистент (AIdocAssistant)

## Описание проекта

Веб-приложение "НИР Ассистент" предназначено для помощи в написании и форматировании научно-исследовательских работ (НИР) в соответствии со стандартом ГОСТ 7.32-2017. Приложение позволяет создавать документы на основе шаблонов, редактировать секции с использованием различных редакторов (включая интеграцию с ИИ для рекомендаций), управлять структурой документа и экспортировать результат в форматах DOCX и PDF.

## Стек технологий

**Backend:**

*   **Язык:** Python 3.11+
*   **Фреймворк:** Flask
*   **База данных:** SQLite
*   **ORM:** SQLAlchemy
*   **Интеграция Flask и SQLAlchemy:** Flask-SQLAlchemy
*   **Миграции базы данных:** Flask-Migrate (использует Alembic под капотом)
*   **Аутентификация:** Flask-Login
*   **Формы:** Flask-WTF (использует WTForms)
*   **Конфигурация:** Файл `.env` / `.flaskenv` (использует `python-dotenv`)
*   **Работа с DOCX:** `python-docx`
*   **Работа с PDF:** `reportlab`
*   **Зависимости ИИ:** (Предположительно, используются библиотеки для взаимодействия с YandexGPT, GigaChat, Gemini API - указать конкретные, если используются)

**Frontend:**

*   **Шаблонизатор:** Jinja2 (встроен в Flask)
*   **HTML / CSS:** Стандартный HTML5. Стилизация, вероятно, с помощью **Tailwind CSS** (судя по классам в примерах).
*   **JavaScript:**
    *   Ванильный JavaScript (для обработки событий, AJAX/Fetch запросов, взаимодействия с DOM).
    *   **Alpine.js** (судя по `x-data`, `x-show` и т.д. в примерах) для легковесной интерактивности.
    *   **CKEditor 5** (или другая библиотека WYSIWYG) для редактирования контента секций.

**Окружение:**

*   **Виртуальное окружение:** `venv`
*   **Веб-сервер (разработка):** Встроенный сервер Flask/Werkzeug
*   **Веб-сервер (продакшен):** (Рекомендуется) Gunicorn, uWSGI + Nginx/Apache

## Структура проекта

```
AIdocAssistant/
│
├── venv/                   # Виртуальное окружение Python
├── web/                    # Основной пакет приложения
│   │
│   ├── app/                # Пакет ядра приложения Flask
│   │   │
│   │   ├── __init__.py     # Фабрика приложения (create_app), инициализация расширений, регистрация Blueprints, CLI команд
│   │   ├── models.py       # Определения моделей SQLAlchemy (User, DocumentApp, DocumentSection, etc.)
│   │   ├── forms/          # Определения форм WTForms (e.g., auth.py)
│   │   │   └── auth.py
│   │   │
│   │   ├── routes/         # Определения Blueprints и view-функций (маршрутов)
│   │   │   ├── auth.py       # Маршруты аутентификации
│   │   │   ├── documents.py  # Маршруты для работы с документами
│   │   │   ├── ai.py         # Маршруты для взаимодействия с ИИ
│   │   │   ├── feedback.py   # Маршруты для обратной связи
│   │   │   └── admin.py      # Маршруты админ-панели
│   │   │
│   │   ├── services/       # Сервисный слой (бизнес-логика, работа с API)
│   │   │   ├── __init__.py
│   │   │   ├── document_service.py # Логика управления документами
│   │   │   ├── export_service.py  # Логика экспорта в DOCX/PDF
│   │   │   └── ai_clients.py      # (Предположительно) Логика работы с ИИ
│   │   │
│   │   ├── templates/      # HTML шаблоны Jinja2
│   │   │   ├── base.html
│   │   │   ├── auth/
│   │   │   ├── documents/
│   │   │   └── ... (другие папки для блюпринтов)
│   │   │
│   │   ├── static/         # Статические файлы (CSS, JS, изображения)
│   │   │   ├── css/
│   │   │   └── js/
│   │   │        └── editor.js #  JS для редактора
│   │   │        └── main.js   # (Предположительно) Общий JS
│   │   │        └── api.js #  JS для работы с API от нейронок
│   │   │        └── admin.js #  JS для админки
│   │   │
│   │   ├── utils/          # Вспомогательные модули, декораторы
│   │   │   └── decorators.py # Декораторы (e.g., log_activity)
│   │   │
│   │   └── seeds.py        # Функция для заполнения БД начальными данными (шаблон госта)
│   │
│   ├── config.py           # Конфигурация приложения Flask
│   ├── run.py              # Скрипт для запуска через 'python run.py'
│   ├── migrations/         # Директория для миграций Alembic (Flask-Migrate)
│   │
│   └── instance/           # Папка для файлов, специфичных для экземпляра (НЕ в Git)
│       └── app.db          # Файл базы данных SQLite
│       └── uploads/        # Папка для загрузок
│           └── exports/    # Сгенерированные документы
│           └── ...
│
├── .env                    # Локальные переменные окружения (НЕ в Git)
├── .flaskenv               # Переменные окружения для Flask CLI (e.g., FLASK_APP)
├── .gitignore              # Файлы и папки, игнорируемые Git
├── requirements.txt        # Список зависимостей Python
└── README.md               # Это файл документации
```

## Установка и запуск

1.  **Клонировать репозиторий:**
    ```bash
    git clone <url-репозитория>
    cd AIdocAssistant
    ```
2.  **Создать и активировать виртуальное окружение:**
    ```bash
    python -m venv venv
    # Windows (PowerShell)
    .\venv\Scripts\Activate.ps1
    # Windows (cmd.exe)
    .\venv\Scripts\activate.bat
    # macOS / Linux
    source venv/bin/activate
    ```
3.  **Установить зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
4.  **Настроить переменные окружения:**
    *   Скопируйте `.env.example` (если есть) в `.env`.
    *   Сгенерируйте и запишите `SECRET_KEY` в `.env`.
    *   Убедитесь, что `DATABASE_URL` в `.env` указывает на правильный путь к файлу БД (например, `sqlite:///C:/path/to/AIdocAssistant/web/instance/app.db` или `sqlite:///instance/app.db`, если запускаете из `web`).
    *   Добавьте API-ключи для YandexGPT, GigaChat, Gemini в `.env`.
    *   Проверьте `.flaskenv` (должен быть в `AIdocAssistant`, содержимое: `FLASK_APP=web.app`).
5.  **Инициализировать и применить миграции базы данных:**
    *   Удалите существующие `web/instance/app.db` и `web/migrations`, если начинаете с нуля.
    *   Перейдите в папку `web`: `cd web`
    *   Инициализируйте (только один раз, если папки `migrations` нет): `flask db init`
    *   Создайте миграцию: `flask db migrate -m "Initial schema"`
    *   Примените миграцию: `flask db upgrade`
    *   Вернитесь в корневую папку: `cd ..`
6.  **Заполнить базу начальными данными:**
    ```bash
    # Находясь в AIdocAssistant
    flask seed-db
    ```
7.  **Запустить приложение:**
    ```bash
    # Находясь в AIdocAssistant
    flask run
    ```
    Приложение будет доступно по адресу `http://127.0.0.1:5000`.

## Ключевые модули и функциональность

*   **Аутентификация (`routes/auth.py`, `forms/auth.py`):** Регистрация, вход, выход пользователей с использованием Flask-Login.
*   **Управление документами (`routes/documents.py`, `services/document_service.py`):** Создание (из шаблона, пустого, загрузкой), просмотр списка, редактирование структуры, редактирование секций, предпросмотр, удаление документов.
*   **Редактор секций (`templates/documents/section_*.html`, `static/js/editor.js`):** Динамический интерфейс для редактирования контента секций с использованием CKEditor и/или форм.
*   **Экспорт (`routes/documents.py`, `services/export_service.py`):** Генерация DOCX и PDF файлов на основе содержимого документа в соответствии с ГОСТ.
*   **Шаблоны и секции (`models.py`, `seeds.py`):** Система шаблонов (пока только ГОСТ) и их стандартных секций, определяющих структуру документа.
*   **Рекомендации ИИ (`routes/ai.py`, `services/ai_service.py`):**  Функциональность для анализа текста секций и предоставления рекомендаций с помощью внешних AI API.

---
Надеюсь, эта структура поможет вашим коллегам быстрее разобраться в проекте